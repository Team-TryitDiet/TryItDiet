<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title></title>
    <links th:include="partials/head :: head"></links>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css"
          href="https://cdn.datatables.net/v/bs4/dt-1.10.22/b-1.6.5/r-2.2.6/sc-2.0.3/sl-1.3.1/datatables.min.css"/>

    <style type="text/css">
        #ingredientTable_wrapper {
            max-width: 500px;
        }
    </style>

</head>
<body>
<div th:replace="partials/navbar :: navbar"></div>

<div class="container">
    <form th:action="@{/posts/recipe/edit}" method="post">
        <input type="hidden" th:field="${post.id}" name="postId">
        <input type="hidden" th:field="${post.recipe.id}" name="recipeId">
        <input type="hidden" th:field="${post.date}" name="date">
        <input type="hidden" th:field="${post.user.id}" name="userId">
        <label for="prep">Recipe Title: </label>
        <br>
        <input th:field="${post.title}" name="title"/>
        <label for="prep">Recipe preparation: </label>
        <br>
        <textarea th:field="${post.recipe.preparation}" name="preparation" id="prep" cols="72" rows="4"></textarea>
        <br>
        <label for="body">Recipe Notes: </label>
        <br>
        <textarea th:field="${post.recipe.notes}" name="notes" id="body" cols="72" rows="4"></textarea>
        <br>

        <table>
            <div class="card" th:each="diet : ${dietsList}">
                <!-- We want to also loop through the ${diets} to see if any of those are already selected -->
                <!-- start the loop here -->
                <span th:switch="${post.recipe.diets.contains(diet)}">
                    <span th:case="${true}">
                        <input type="checkbox" name="diets" th:text="${diet.title}" th:value="${diet.id}"
                               checked="checked"/>
                    </span>
                    <span th:case="*">
                        <input type="checkbox" name="diets" th:text="${diet.title}" th:value="${diet.id}"/>
                    </span>
                    <!--change  it to checked if it already is selected for this recipe -->
                    <!-- end the loop here -->
                    <br>
                </span>
            </div>
        </table>
        <span id="testHiddenIngredients">
            <input type="hidden" th:each="ingredient : ${post.recipe.ingredients}" th:value="${ingredient.id}"/>
        </span>
        <table id="ingredientTable" class="display" style="width: 500px">
            <thead>
            <th>ID</th>
            <th>Name</th>
            </thead>
            <tfoot>
            <th>ID</th>
            <th>Name</th>
            </tfoot>
        </table>
        <!-- DataTable selections go here -->
        <div id="hiddenIngredients"></div>
        <button type="submit" id="submitBtn">Save</button>

    </form>
</div>

<!--<footer th:replace="partials/footer :: footer"></footer>-->
<scripts th:replace="partials/scripts :: scripts"/>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"></script>
<script type="text/javascript"
        src="https://cdn.datatables.net/v/bs4/dt-1.10.22/b-1.6.5/r-2.2.6/sc-2.0.3/sl-1.3.1/datatables.min.js"></script>
<!-- Include the JS file with the AJAX request -->
<script type="text/javascript" th:src="@{/js/ingredients.js}"></script>
</body>
</html>